<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RPG em C: L√≥gica e Arquitetura de C√≥digo</title>
    <link rel="stylesheet" href="style_03.css">
</head>
<body>
    <video id="meuvideo" src="../midias/wallpaper.mp4" autoplay muted loop></video>

    <header id="cabecalho">
        <div id="cabecalho_flex">
            <a href="https://portal.uern.br/" target="_blank"><img src="../midias/LOGOMARCA_UERN_Branca.png" class="uern" alt="Logo UERN"></a>
            <div id="texoCabe">
                <h1 id="saudacao">Arquitetura de C√≥digo</h1>
                <a href="../segunda.html">
                    <h1 id="descr">L√≥gica de Inicializa√ß√£o, F√≥rmulas de Combate e Gerenciamento de Buffer/Mem√≥ria em C.</h1>
                </a>
            </div>
            <a href="https://github.com/NielS2Dev" target="_blank" class="nielpequeno"><img src="../midias/niel_pequeno2.png" alt="Desenvolvedor"></a>
        </div>
    </header>

    <main>
        <div class="container">
            <h1>üîß Modularizando o nosso programa üì¶</h1>
            <h2>N√≥s usamos a modulariza√ß√£o para organizar a arquitetura do c√≥digo.</h2>
            <p>
                Ap√≥s a finaliza√ß√£o do programa, **n√≥s decidimos implementar a modulariza√ß√£o** para organizar a arquitetura do c√≥digo C. Este processo envolveu separar responsabilidades em arquivos `.c` (implementa√ß√£o) e usar arquivos de cabe√ßalho (`.h`) para as declara√ß√µes (interface), garantindo que cada parte do jogo fosse independente e f√°cil de dar manuten√ß√£o.
            </p>

            <section class="configuracao-rpg">
                
                <h3 id="principios">Princ√≠pios Fundamentais da Nossa Modulariza√ß√£o</h3>
                <p>Nossa arquitetura se baseia na separa√ß√£o de responsabilidades:</p>
                <ul>
                    <li>
                        <p><strong>Interface (`.h`):</strong> Cont√©m apenas as **declara√ß√µes** (prot√≥tipos de fun√ß√µes, `structs` e vari√°veis globais com o `extern`). Diz **O QUE** o m√≥dulo faz.</p>
                    </li>
                    <li>
                        <p><strong>Implementa√ß√£o (`.c`):</strong> Cont√©m o c√≥digo real e a l√≥gica interna das fun√ß√µes. Diz **COMO** o m√≥dulo faz.</p>
                        <div id="imagem_001">
                            <a href="" class="fotogeral"><img src="../midias/modulos.png" alt="Exemplo de modulos do c√≥digo" title="Estrutura de arquivos .c e .h"></a>
                        </div>
                    </li>
                    <li>
                        <p><strong>Organiza√ß√£o:</strong> Utilizamos **`#ifndef` guards** em todos os arquivos `.h` para prevenir que o compilador processe o mesmo cabe√ßalho v√°rias vezes e cause erros de redefini√ß√£o.</p>
                    </li>
                </ul>

                <h4>Vis√£o Geral dos M√≥dulos Utilizados</h4>
                <p>N√≥s dividimos o jogo em m√≥dulos l√≥gicos, facilitando a depura√ß√£o e o desenvolvimento:</p>
                <ul>
                    <li>
                        <h2>`playgame.c` / `main.c` (Loop Principal)</h2>
                        <p>Respons√°vel pelo **n√∫cleo do jogo**: inicializa√ß√£o, cria√ß√£o do `struct usuario`, solicita√ß√£o e valida√ß√£o do *nick*, sele√ß√£o de classe e o *loop* principal que sorteia o monstro e chama a fun√ß√£o `lutar()`.</p>
                    </li>
                    <li>
                        <h2>`combate.c` (L√≥gica de Batalha)</h2>
                        <p>Cont√©m a **l√≥gica de combate**: define a `struct habilidade`, o `bancoDeSkills` para as classes e a fun√ß√£o **`lutar()`**, que gerencia o fluxo de turnos, calcula dano e exibe o resultado da batalha.</p>
                    </li>
                    <li>
                        <h2>`monstro.c` (Dados dos Inimigos)</h2>
                        <p>Funciona como o **banco de dados das criaturas**: define a `struct monstros` e a lista global `listaDeMonstros` com todas as estat√≠sticas base dos inimigos.</p>
                    </li>
                    <li>
                        <h2>`pocao.c` (Sistema de Itens)</h2>
                        <p>Implementa o **sistema de po√ß√µes**: define a `struct porcao`, a lista de po√ß√µes, a fun√ß√£o `menuPorcoes()` e a l√≥gica para **`aplicarPorcao`** no her√≥i, controlando o limite de usos.</p>
                    </li>
                    <li>
                        <h2>`animacao.c` (Utilit√°rios de Console)</h2>
                        <p>M√≥dulo de **fun√ß√µes de baixo n√≠vel**: inclui fun√ß√µes como `animacao` (mover cursor), `print_animado` (efeito de digita√ß√£o), `mostrarDataHoraAtual` e, crucialmente, `limparBuffer`.</p>
                    </li>
                    <li>
                        <h2>`desenhos.c` (Interface Visual)</h2>
                        <p>Cont√©m todas as fun√ß√µes de **arte ASCII** e formata√ß√£o de console, como os desenhos dos monstros (`desenharOrc()`), classes e telas de vit√≥ria/derrota.</p>
                    </li>
                </ul>

                <h3 id="detalhes-tecnicos">Detalhes T√©cnicos Essenciais</h3>
                
                <h4>1. Gerenciamento de Mem√≥ria (Limpeza de Buffer)</h4>
                <p>
                    Para garantir que a entrada do jogador n√£o gerasse erros nos inputs futuros, n√≥s utilizamos a fun√ß√£o **`limparBuffer()`** (definida no m√≥dulo `animacao.c`).
                </p>
                <div id="imagem_002">
                    <a href="" class="fotogeral"><img src="../midias/limparbuffer.png" alt="Implementa√ß√£o da fun√ß√£o limparBuffer()" title="Fun√ß√£o para limpar o buffer de entrada"></a>
                </div>
                <p>
                    Ap√≥s qualquer `scanf`, a l√≥gica chama `limparBuffer()`. Isso √© vital para a robustez do programa, pois previne que o caractere de quebra de linha (`\n`) deixado pelo `scanf` interfira na pr√≥xima leitura de input.
                </p>

                <h4>2. L√≥gica Matem√°tica do Combate em `combate.c`</h4>
                <p>O c√°lculo de dano √© uma subtra√ß√£o controlada, central para a din√¢mica do RPG:</p>
                <div id="imagem_003_004">
                    <a href="" class="fotogeral"><img src="../midias/formuladedano.png" alt="F√≥rmula de c√°lculo de dano no c√≥digo" title="C√°lculo de dano e defesa"></a>
                </div>
                <ul>
                    <li>
                        <p><strong>Mitiga√ß√£o de Dano:</strong> O dano efetivo √© calculado por:</p>
                        $$\text{Dano Causado} = (\text{Dano Bruto}) - (\text{Monstro.Defesa})$$
                    </li>
                    <li>
                        <p><strong>Regra de Dano M√≠nimo:</strong> A l√≥gica inclui um piso de dano: <code>if (danoCausado < 1) danoCausado = 1;</code>. Isso garante que o her√≥i nunca erre e sempre cause **um ponto de dano**, independentemente da defesa do monstro.</p>
                    </li>
                    <li>
                        <p><strong>Contra-Ataque:</strong> O dano recebido usa a mesma l√≥gica: <code>Dano Recebido = Monstro.Ataque - Her√≥i.Defesa</code>.</p>
                    </li>
                </ul>

                <h3>3. A L√≥gica de Recursos e Rastreabilidade da Po√ß√£o</h3>
                <p>O m√≥dulo `pocao.c` implementa uma l√≥gica de desvio estrat√©gico do combate:</p>
                <ul>
                    <li>
                        <p><strong>Controle de Uso:</strong> A fun√ß√£o `menuPorcoes()` verifica se `heroi->usosPocao` atingiu o **`LIMITE_USO_PORCAO` (2)**. Se o limite for atingido, a l√≥gica exibe um erro e retorna, preservando o turno.</p>
                    </li>
                    <li>
                        <p><strong>Aplica√ß√£o Segura (`aplicarPorcao()`):</strong></p>
                        <ul style="list-style-type: circle;">
                            <li><p><strong>Cura:</strong> A l√≥gica previne *overflow* de vida usando <code>if (heroi->vidaAtual > heroi->vidaMaxima)</code> para que a cura nunca exceda a vida m√°xima.</p></li>
                            <li><p><strong>Buff:</strong> B√¥nus de Ataque/Defesa s√£o somados diretamente, tornando o **buff persistente** por toda a sess√£o.</p></li>
                        </ul>
                    </li>
                    <li>
                        <p><strong>Registro de Po√ß√£o (O Log):</strong> Ap√≥s o uso, <code>salvarLogPorcao()</code> gera o *timestamp* exato e registra o item e o uso atual no <code>HistoricoJogadores.txt</code>.</p>
                    </li>
                </ul>

                <h3>4. Finaliza√ß√£o da Batalha e L√≥gica de Encerramento</h3>
                <p>O fim da fun√ß√£o `lutar()` √© o momento final de decis√£o l√≥gica e de log de cada rodada:</p>
                <div id="imagem06">
                    <a href="" class="fotogeral"><img src="../midias/logfinal.png" alt="Estrutura if/else if de encerramento de lutar()" title="Decis√£o de Vit√≥ria/Derrota no Combate"></a>
                </div>
                <ul>
                    <li>
                        <p><strong>Condicionais de Resultado:</strong> A l√≥gica usa <code>if / else if</code> para determinar o fim do loop:</p>
                        <ul style="list-style-type: circle;">
                            <li><p><strong>Vit√≥ria:</strong> <code>if (vidaMonstroAtual <= 0)</code> ‚Äî Exibe <code>venceu()</code> e registra log de **DERROTOU**.</p></li>
                            <li><p><strong>Derrota:</strong> <code>else if (heroi->vidaAtual <= 0)</code> ‚Äî Exibe <code>gameOver()</code> e registra log de **MORREU**.</p></li>
                        </ul>
                    </li>
                    <li>
                        <p><strong>Registro Final de Combate:</strong> A fun√ß√£o <code>salvarLogBatalha()</code> gera o *timestamp* final da luta e registra o resultado, capturando a vida restante do her√≥i em caso de vit√≥ria ou o inimigo fatal em caso de derrota.</p>
                    </li>
                </ul>
            </section>
        </div>
        <div id="navegacao-doc">
            <a href="parte006.html" class="nav-link voltar">
                <span class="icone-seta">‚¨ÖÔ∏è</span> 
                <span class="texto-nav">Anterior: [T√≥pico Anterior]</span>
            </a>

            <a href="parte007.html" class="nav-link proximo">
                <span class="texto-nav">Pr√≥ximo: [Pr√≥ximo T√≥pico]</span>
                <span class="icone-seta">‚û°Ô∏è</span>
            </a>
        </div>
    </main>

    <footer>
        <a href="https://github.com/NielS2Dev" target="_blank">
            <p>Site Desenvolvido por Antoniel da Silva e Pedro Dias</p>
        </a>
    </footer>

    <script type="module" src="script_001.js"></script>
</body>
</html>